"use strict";const input=document.querySelector(".js-input"),button=document.querySelector(".js-button"),listContainer=document.querySelector(".js-list"),listFavourites=document.querySelector(".js-list-favourites"),paragraph=document.querySelector(".js-paragraph"),buttonReset=document.querySelector(".js-reset");let dataResults=[],listFav=[],localFav={};function search(){""===input.value?paragraph.innerHTML="You must enter a TV show name":(paragraph.innerHTML="",getInfoFromApi())}function getInfoFromApi(){fetch("//api.tvmaze.com/search/shows?q="+input.value).then(t=>t.json()).then(t=>{dataResults=t,paintSearch(),listenItem()})}function paintSearch(){listContainer.innerHTML="";for(let t=0;t<dataResults.length;t++){const e=document.createElement("li"),a=document.createElement("img"),s=document.createElement("p"),i=document.createTextNode(""+dataResults[t].show.name);if(listContainer.appendChild(e),e.classList.add("js-item"),e.classList.add("searchSection__listItem"),e.setAttribute("id",""+dataResults[t].show.id),null===dataResults[t].show.image)a.setAttribute("src","//via.placeholder.com/210x295/ffffff/666666");else{const e=dataResults[t].show.image.medium.replace("http:","");a.setAttribute("src",e)}e.appendChild(a),a.classList.add("searchSection__listItem--image"),e.appendChild(s),s.appendChild(i),s.classList.add("searchSection__listItem--title")}}function paintFavourites(){listFavourites.innerHTML="";for(let t=0;t<listFav.length;t++){const e=document.createElement("li"),a=document.createElement("img"),s=document.createElement("p"),i=document.createTextNode(""+listFav[t].name),n=document.createElement("button"),o=document.createTextNode("X");if(listFavourites.appendChild(e),e.classList.add("favouriteSection__listItem"),e.setAttribute("id",""+listFav[t].id),null===listFav[t].image)a.setAttribute("src","//via.placeholder.com/210x295/ffffff/666666");else{const e=listFav[t].image.medium.replace("http:","");a.setAttribute("src",e)}e.appendChild(a),a.classList.add("favouriteSection__listItem--image"),e.appendChild(s),s.appendChild(i),s.classList.add("favouriteSection__listItem--title"),e.appendChild(n),n.appendChild(o),n.classList.add("favouriteSection__listItem--button","js-removeButtons"),n.setAttribute("data-id",listFav[t].id),n.addEventListener("click",removeFavourites)}}function removeFavourites(t){for(let e=0;e<listFav.length;e++)parseInt(t.currentTarget.dataset.id)===parseInt(listFav[e].id)&&listFav.splice([e],1);paintFavourites(),paintSearch(),listenItem()}function addFav(t){const e=document.getElementById(t);e.classList.remove("searchSection__listItem"),e.classList.add("searchSection__listItem--favourite")}function removeFav(t){const e=document.getElementById(t);e.classList.remove("searchSection__listItem--favourite"),e.classList.add("searchSection__listItem")}function favouriteSeries(t){console.log(listFav);for(let e=0;e<dataResults.length;e++)t.currentTarget.id==dataResults[e].show.id&&(localFav={id:dataResults[e].show.id,name:dataResults[e].show.name,image:dataResults[e].show.image});const e=parseInt(t.currentTarget.id),a=listFav.findIndex(e=>e.id==t.currentTarget.id);!0===(-1===a)?(listFav.push(localFav),addFav(e),paintFavourites()):(listFav.splice(a,1),paintFavourites(),removeFav(e)),setInLocalStorage()}function listenItem(){const t=document.querySelectorAll(".js-item");for(const e of t)e.addEventListener("click",favouriteSeries)}function setInLocalStorage(){localStorage.setItem("favourites",JSON.stringify(listFav))}function getFromLocalStorage(){const t=localStorage.getItem("favourites"),e=JSON.parse(t);null===e?getInfoFromApi():(listFav=e,paintFavourites())}function resetFavourites(){listFav=[],localStorage.removeItem("favourites"),paintFavourites(),paintSearch(),listenItem()}button.addEventListener("click",search),buttonReset.addEventListener("click",resetFavourites),getFromLocalStorage();